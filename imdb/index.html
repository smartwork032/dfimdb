<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IMDB Generator - DudeFilms</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1f2937; 
        }
        ::-webkit-scrollbar-thumb {
            background: #4b5563; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #6b7280; 
        }
        .glass-panel {
            background: rgba(31, 41, 55, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(75, 85, 99, 0.4);
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen">

    <!-- Navbar -->
    <nav class="border-b border-gray-800 bg-gray-900/95 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-3">
                    <i class="fa-solid fa-clapperboard text-blue-500 text-2xl"></i>
                    <h1 class="text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-500">
                        IMDB Post Gen <span class="text-gray-500 text-sm font-medium ml-2">for <a href="https://dudefilms.in" target="_blank" class="hover:text-blue-400 transition">DudeFilms</a></span>
                    </h1>
                </div>
                <div class="text-xs text-gray-500 bg-gray-800 px-3 py-1 rounded-full border border-gray-700">
                    <i class="fa-solid fa-bolt text-yellow-500 mr-1"></i> Fast Mode
                </div>
            </div>
        </div>
    </nav>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- Main Form Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            
            <!-- LEFT COLUMN: Inputs -->
            <div class="lg:col-span-5 space-y-6">
                
                <!-- ID Fetcher Card -->
                <div class="glass-panel rounded-xl p-6 shadow-lg">
                    <h2 class="text-lg font-semibold mb-4 text-blue-400 flex items-center gap-2">
                        <i class="fa-brands fa-imdb text-yellow-500 text-xl"></i> Fetch Details
                    </h2>
                    <div class="flex gap-2">
                        <div class="relative w-full">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <span class="text-gray-500 text-sm">tt</span>
                            </div>
                            <input type="text" id="imdb_id" placeholder="4154796" 
                                class="w-full pl-8 pr-4 py-3 bg-gray-800 border border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition text-white placeholder-gray-500"
                                value="">
                        </div>
                        <button id="btn_generate" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition shadow-lg shadow-blue-900/20 flex items-center gap-2">
                            <i class="fa-solid fa-wand-magic-sparkles"></i>
                            <span>Fetch</span>
                        </button>
                    </div>
                    <p class="text-xs text-gray-500 mt-2 ml-1">Enter IMDB ID (e.g., tt1234567)</p>
                </div>

                <!-- Manual Details Card -->
                <div class="glass-panel rounded-xl p-6 shadow-lg space-y-5">
                    <h2 class="text-lg font-semibold mb-2 text-gray-300 border-b border-gray-700 pb-2">
                        Configuration
                    </h2>

                    <!-- Quality & Size (The Requested New Feature) -->
                    <div>
                        <label class="block text-sm font-medium text-gray-400 mb-1">Quality & Size String</label>
                        <div class="relative">
                            <input type="text" id="quality_size" 
                                class="w-full px-4 py-3 bg-gray-800 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none transition text-white font-mono text-sm"
                                placeholder="480p [400MB] || 720p [800MB] || 1080p [2.GB]"
                                value="480p [400MB] || 720p [900MB] || 1080p [2.4GB]">
                            <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                <i class="fa-solid fa-layer-group text-gray-500"></i>
                            </div>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">Format: <code>Quality [Size] || Quality [Size]</code></p>
                    </div>

                    <!-- Row 1 -->
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-400 mb-1">Language</label>
                            <input type="text" id="lang" list="lang_options" value="Hindi" class="w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg focus:ring-blue-500 outline-none text-sm placeholder-gray-500">
                            <datalist id="lang_options">
                                <option value="Hindi"></option>
                                <option value="English"></option>
                                <option value="Dual audio {Hindi-English}"></option>
                                <option value="Multi Audio"></option>
                            </datalist>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-400 mb-1">Source</label>
                            <input type="text" id="source" list="source_options" value="WEB-DL" class="w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg focus:ring-blue-500 outline-none text-sm placeholder-gray-500">
                            <datalist id="source_options">
                                <option value="WEB-DL"></option>
                                <option value="BluRay"></option>
                                <option value="HDTC"></option>
                                <option value="HDTS"></option>
                                <option value="CamRip"></option>
                                <option value="CamHD"></option>
                                <option value="WebRip"></option>
                            </datalist>
                        </div>
                    </div>

                    <!-- Row 2 -->
                    <div>
                        <label class="block text-sm font-medium text-gray-400 mb-1">Subtitles</label>
                        <input type="text" id="subtitle" value="English" class="w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg focus:ring-blue-500 outline-none text-sm">
                    </div>

                    <!-- Row 3 -->
                    <div>
                        <label class="block text-sm font-medium text-gray-400 mb-1">Screenshot URL</label>
                        <div class="flex">
                            <input type="text" id="screenshot" class="w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-l-lg focus:ring-blue-500 outline-none text-sm placeholder-gray-600" placeholder="https://image.url/shot.jpg">
                            <span class="inline-flex items-center px-3 bg-gray-700 border border-l-0 border-gray-700 rounded-r-lg text-gray-400">
                                <i class="fa-regular fa-image"></i>
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- RIGHT COLUMN: Outputs -->
            <div class="lg:col-span-7 space-y-6">
                
                <!-- Result Card -->
                <div class="glass-panel rounded-xl p-6 shadow-lg h-full flex flex-col">
                    <div class="flex items-center justify-between mb-6 border-b border-gray-700 pb-4">
                        <h2 class="text-lg font-semibold text-green-400">Generated Output</h2>
                        <span id="status_msg" class="text-xs font-mono text-gray-500 opacity-0 transition-opacity duration-300">Copied to clipboard!</span>
                    </div>

                    <!-- Title Output -->
                    <div class="mb-5">
                        <div class="flex justify-between items-end mb-1">
                            <label class="text-xs uppercase tracking-wider text-gray-500 font-bold">Post Title</label>
                            <button onclick="copyToClipboard('out_title')" class="text-xs bg-gray-700 hover:bg-gray-600 text-white px-2 py-1 rounded transition">
                                <i class="fa-regular fa-copy"></i> Copy
                            </button>
                        </div>
                        <input type="text" id="out_title" readonly 
                            class="w-full px-4 py-3 bg-gray-900 border border-gray-700 rounded-lg text-green-400 font-mono text-sm focus:ring-1 focus:ring-green-500 outline-none">
                    </div>

                    <!-- Image URL Output -->
                    <div class="mb-5">
                        <div class="flex justify-between items-end mb-1">
                            <label class="text-xs uppercase tracking-wider text-gray-500 font-bold">Poster URL</label>
                            <div class="flex gap-2">
                                <button onclick="openImage()" class="text-xs bg-gray-700 hover:bg-gray-600 text-white px-2 py-1 rounded transition">
                                    <i class="fa-solid fa-arrow-up-right-from-square"></i> Open
                                </button>
                                <button onclick="copyToClipboard('out_img')" class="text-xs bg-gray-700 hover:bg-gray-600 text-white px-2 py-1 rounded transition">
                                    <i class="fa-regular fa-copy"></i> Copy
                                </button>
                            </div>
                        </div>
                        <input type="text" id="out_img" readonly 
                            class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-blue-300 font-mono text-xs focus:ring-1 focus:ring-blue-500 outline-none">
                    </div>

                    <!-- Main HTML Content -->
                    <div class="flex-grow flex flex-col">
                        <div class="flex justify-between items-end mb-1">
                            <label class="text-xs uppercase tracking-wider text-gray-500 font-bold">Post Content (HTML)</label>
                            <button onclick="copyToClipboard('out_content')" class="text-xs bg-gray-700 hover:bg-gray-600 text-white px-2 py-1 rounded transition">
                                <i class="fa-regular fa-copy"></i> Copy HTML
                            </button>
                        </div>
                        <textarea id="out_content" readonly 
                            class="w-full flex-grow p-4 bg-gray-900 border border-gray-700 rounded-lg text-gray-300 font-mono text-xs leading-relaxed focus:ring-1 focus:ring-gray-500 outline-none resize-none"
                            style="min-height: 300px;"></textarea>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Logic Script -->
    <script>
        const API_KEY = "c0d64821"; // OMDb API Key from original file

        document.getElementById('btn_generate').addEventListener('click', generatePost);

        async function generatePost() {
            const imdbIdInput = document.getElementById('imdb_id').value.trim();
            // Handle both full URL and raw ID
            let imdbId = imdbIdInput;
            const urlMatch = imdbIdInput.match(/tt\d+/);
            if (urlMatch) {
                imdbId = urlMatch[0];
            }

            if (!imdbId) {
                alert("Please enter a valid IMDB ID (e.g., tt4154796)");
                return;
            }

            setLoading(true);

            try {
                const response = await fetch(`https://www.omdbapi.com/?apikey=${API_KEY}&plot=full&i=${imdbId}`);
                const data = await response.json();

                if (data.Response === "False") {
                    alert("Movie not found! Check the ID.");
                    setLoading(false);
                    return;
                }

                populateData(data);
                
            } catch (error) {
                console.error(error);
                alert("Error connecting to OMDb API.");
            }
            
            setLoading(false);
        }

        function populateData(data) {
            // Inputs
            const lang = document.getElementById('lang').value;
            const source = document.getElementById('source').value;
            const subtitle = document.getElementById('subtitle').value;
            const screenshot = document.getElementById('screenshot').value;
            const qualitySizeString = document.getElementById('quality_size').value;

            // Parse Quality/Size String (e.g., "480p [400MB] || 720p [1GB]")
            const variants = parseQualityString(qualitySizeString);
            
            // Build Quality Links HTML
            let qualityLinksHtml = "";
            let qualityListText = "";
            
            if (variants.length > 0) {
                // Generate HTML links: <a href="/category/480p/">480p</a>
                const linkArray = variants.map(v => `<a href="/category/${v.quality.toLowerCase()}/">${v.quality}</a>`);
                
                if (linkArray.length === 1) {
                    qualityLinksHtml = linkArray[0];
                } else if (linkArray.length === 2) {
                    qualityLinksHtml = linkArray.join(" &amp; ");
                } else {
                    const last = linkArray.pop();
                    qualityLinksHtml = linkArray.join(", ") + " &amp; " + last;
                }
            } else {
                // Fallback
                qualityLinksHtml = `<a href="/category/1080p/">1080p</a>, <a href="/category/720p/">720p</a> &amp; <a href="/category/480p/">480p</a>`;
            }

            // Site constants
            const siteTitle = '<a href="https://dudefilms.in">DudeFilms</a>';
            const siteName = "DudeFilms";
            
            // Generate Title
            // Format: Title (Year) Lang Source Subtitle - 480p [Size] || 720p [Size]
            let subtitlePart = "";
            if (subtitle && subtitle.trim() !== "") {
                subtitlePart = ` ${subtitle}`;
            }

            const generatedTitle = `${data.Title} (${data.Year}) ${lang} Movie ${source}${subtitlePart} - ${qualitySizeString}`;

            // Generate Subtitle List Item
            const subtitleHtml = subtitle ? `<li><strong>Subtitle:</strong> ${subtitle}</li>` : '';

            // Generate Plot/Details
            // Replicating the specific HTML structure from original file
            let contentHtml = `<p><b>Download ${data.Title} (${data.Year}) Full Movie</b>. This is a <strong>${lang}</strong> movie and is available in ${qualityLinksHtml} Qualities For Your Mobile/tablet/Computer. This movie is based on <strong>${data.Genre}</strong>.</p><br><strong>${siteTitle} </strong>Provide You Super Quality Of Movies and WEB Series. We Provide Google Drive Direct Download Links For Fast And Secure Download. You Can Join us on Telegram For Latest Updates.<br> [imdb style="dark"]${data.imdbID}[/imdb]<br><h3 style="text-align: center;">Download ${data.Title} (${data.Year}) ${lang} Full Movie ~ ${siteTitle}</h3><p align="center"><b>IMDB Rating</b>: ${data.imdbRating}<br><strong>Directed:</strong> ${data.Director}<br><strong>Released Date:</strong> ${data.Released}<br><strong>Genre:</strong> ${data.Genre}<br><strong>Film Stars:</strong> ${data.Actors}<br><strong>Plot:</strong> ${data.Plot}</p><hr /><img class="aligncenter" src="https://i.imgur.com/ZuRn1nF.png" /><br>`;

            if (screenshot) {
                contentHtml += `<img class="aligncenter" src="${screenshot}" /><hr />`;
            }

            contentHtml += `<img class="aligncenter" src="https://i.imgur.com/4VtZS20.png" />`;

            // Set Values
            document.getElementById('out_title').value = generatedTitle;
            document.getElementById('out_img').value = data.Poster; // High res poster if available
            document.getElementById('out_content').value = contentHtml;
        }

        // Helper: Parse the "480p [300MB] || 720p [1GB]" format
        function parseQualityString(str) {
            if (!str) return [];
            // Split by ||
            const parts = str.split('||');
            const results = [];
            
            parts.forEach(part => {
                const cleanPart = part.trim();
                // match "480p" at start
                const match = cleanPart.match(/^(\d{3,4}p|4k|HD)/i);
                if (match) {
                    results.push({
                        full: cleanPart,
                        quality: match[0] // e.g., "480p"
                    });
                }
            });
            return results;
        }

        function setLoading(isLoading) {
            const btn = document.getElementById('btn_generate');
            if (isLoading) {
                btn.innerHTML = '<i class="fa-solid fa-circle-notch fa-spin"></i> Fetching...';
                btn.classList.add('opacity-75', 'cursor-not-allowed');
            } else {
                btn.innerHTML = '<i class="fa-solid fa-wand-magic-sparkles"></i> Fetch';
                btn.classList.remove('opacity-75', 'cursor-not-allowed');
            }
        }

        function copyToClipboard(elementId) {
            const el = document.getElementById(elementId);
            el.select();
            el.setSelectionRange(0, 99999);
            
            // Clipboard API (Modern) fallback to execCommand
            if (navigator.clipboard) {
                navigator.clipboard.writeText(el.value).then(() => showToast());
            } else {
                document.execCommand('copy');
                showToast();
            }
        }

        function openImage() {
            const url = document.getElementById('out_img').value;
            if (url) window.open(url, '_blank');
        }

        function showToast() {
            const msg = document.getElementById('status_msg');
            msg.classList.remove('opacity-0');
            setTimeout(() => {
                msg.classList.add('opacity-0');
            }, 2000);
        }
    </script>
</body>
</html>
